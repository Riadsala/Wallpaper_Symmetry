\documentclass[11pt, twoside]{article}
\usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage[affil-it]{authblk}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{multicol}
\usepackage{natbib}
\usepackage{geometry}
\usepackage{amsmath}
\usepackage{lineno}
\usepackage[dvipsnames]{xcolor}
\usepackage{hyperref}
\usepackage{xcolor}
\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}

\linenumbers
 \geometry{a4paper, total={170mm,257mm}, left=20mm, top=20mm}

\renewcommand{\baselinestretch}{1.3}

\title{\huge The human visual system preserves the hierarchy of 2-dimensional pattern regularity}
\author[1,2,3]{Peter J. Kohler}
\author[4]{Alasdair D. F. Clarke}

\affil[1]{\small York University, Department of Psychology, Toronto, ON M3J 1P3, Canada}
\affil[2]{\small Centre for Vision Research, York University, Toronto, ON, M3J 1P3, Canada}
\affil[3]{\small Stanford University, Department of Psychology, Stanford, CA 94305, United States}
\affil[4]{\small University of Essex, Department of Psychology, Colchester, UK, CO4 3SQ}

\date{}

\begin{document}

\maketitle

\begin{abstract}
Symmetries are present at many scales in natural scenes. Humans and other animals are highly sensitive to visual symmetry, and symmetry contributes to numerous domains of visual perception. The four fundamental symmetries, reflection, rotation, translation and glide reflection, can be combined into exactly 17 distinct regular textures. These \textit{wallpaper groups} represent the complete set of symmetries in 2D images. The current study seeks to provide a more comprehensive description of responses to symmetry in the human visual system, by collecting both brain imaging (Steady-State Visual Evoked Potentials measured using high-density EEG) and behavioral (symmetry detection thresholds) data using the entire set of wallpaper groups. This allows us to probe the hierarchy of complexity among wallpaper groups, in which simpler groups are subgroups of more complex ones. We find that both behavior and brain activity preserve the hierarchy almost perfectly: Subgroups consistently produce lower amplitude symmetry-specific responses in visual cortex and require longer presentation durations to be reliably detected. These findings expand our understanding of symmetry perception by showing that the human brain encodes symmetries with a high level of precision and detail. This opens new avenues for research on how fine-grained representations of regular textures contribute to natural vision.
\end{abstract}

Symmetries are abundant in natural and man-made environments, due to a complex interplay of physical forces that govern pattern formation in nature. Sensitivity to symmetry has been demonstrated in a number of species, includes bees \citep{giurfa_insect_symmetry_1996}, fish \citep{morris_swordtail_symmetry_1998,schluter_sailfin_symmetry_1998}, birds \citep{RN1337,swaddle_symmetry_finches_1994} and dolphins \citep{von_fersen_dolphin_symmetry_1992}, and may be used as a cue for mate selection in many species \citep{swaddle_asymmetry_review_1999} including humans \citep{rhodes_facial_1998}. Humans cultures have created and appreciated symmetrical patterns throughout history, and since the gestalt movement of the early 20th century, symmetry has been recognized as important for visual perception. Symmetry contributes to the perception of shapes \citep{RN1311,RN1682}, scenes \citep{apthorp_symmetry_numerosity} and surface properties \citep{RN1166}. This literature is almost exclusively based on stimuli in which one or more symmetry axes are placed at a single point in the image. Focus has been on mirror symmetry or \textit{reflection}, with relatively few studies including the other fundamental symmetries: \textit{rotation}, \textit{translation} and \textit{glide reflection} \citep{wagemans_1998} - perhaps because reflection has been found to be more perceptually salient \citep{mach_1959,royer_1981,palmer_1991,ogden_2016,hamada_1988} and produce more brain activity \citep{makin_2013,makin_2014,makin_2012,wright_2015}. In the current study, we take a different approach by investigating visual processing of regular textures in which combinations of the four fundamental symmetries tile the 2D plane.

In the two spatial dimensions relevant for images, symmetries can be combined in 17 distinct ways, \textit{the wallpaper groups} \citep{RN1562,RN1563,RN1425}. Previous work on a subset of four of the wallpaper groups used functional MRI to demonstrate that rotation symmetries in wallpapers elicit parametric responses in several areas in occipital cortex, beginning with visual area V3 \citep{RN1725}. This effect was also robust when symmetry responses were measured with electroencephalography (EEG) using both Steady-State Visual Evoked Potentials (SSVEPs)\citep{RN1725} and Event-Related Potentials \citep{RN1959}. The SSVEP technique uses periodic visual stimulation to produce a periodic brain response that is confined to integer multiples of the stimulation frequency known as harmonics. SSVEP response harmonics can be isolated in the frequency domain and depending on the specific design, different harmonics will express different aspects of the brain response. \citep{RN1540}. Here we extend on the previous work by collecting SSVEPs and psychophysical data from human participants viewing the full set of wallpaper groups. We measure responses in visual cortex to 16 out of the 17 wallpaper groups, with the 17th serving as a control stimulus. Our goal is to provide a more complete picture of how wallpaper groups are represented in the human visual system.

A wallpaper group is a topologically discrete group of isometries of the Euclidean plane, i.e. transformations that preserve distance \citep{RN1425}. The wallpaper groups differ in the number and kind of these transformations and we can uniquely refer to different groups using crystallographic notation. In brief, most groups are notated by $PXZ$, where $X\in\{1,2,3,4,6\}$ indicates the highest order of rotation symmetry and $Z\in\{m, g\}$ indicates whether the pattern contains reflection (m) or glide reflection (g). For example, $P4$ contains rotation of order 4, while $P4MM$ contains rotation of order 4 and two reflections. By convention, many of the groups are given shortened names: for example, $P4MM$ is usually referred to as $P4M$, as the second reflection can be deduced from the presence of rotation of order 4 alongside a reflection. Two of the groups start with a $C$ rather than a $P$, ($CM$ and $CMM$) which indicates that the symmetries are specified relative to a cell that itself contains repetition. Full details of the naming convention can be found on \href{https://en.wikipedia.org/wiki/Wallpaper_group}{wikipedia} and examples of the wallpaper groups are shown in Figures \ref{fig:subgroups} and \ref{fig:summary}.

In mathematical group theory, when the elements of one group is completely contained in another, the inner group is called a subgroup of the outer group \citep{RN1425}. The full list of subgroup relationships is listed in Section 1.4.2 of the Supplementary Material. Subgroup relationships between wallpaper groups can be distinguished by their indices. The index of a subgroup relationship is the number of cosets, i.e. the number of times the subgroup is found in the supergroup \citep{RN1425}. As an example, let us consider groups \textit{P2} and \textit{P6} (see Figure \ref{fig:subgroups}B). If we ignore the translations in two directions that both groups share, group \textit{P6} consists of the set of rotations \{$0^{\circ}$, $60^{\circ}$, $120^{\circ}$, $180^{\circ}$, $240^{\circ}$, $300^{\circ}$\}, in which \textit{P2} \{$0^{\circ}$, $180^{\circ}$\} is contained. \textit{P2} is thus a subgroup of \textit{P6}, and \textit{P6} can be generated by combining \textit{P2} with rotations \{$0^{\circ}$, $120^{\circ}$, $240^{\circ}$\}. Because \textit{P2} is repeated three times in \textit{P6}, \textit{P2} is a subgroup of \textit{P6} with index 3 \citep{RN1425}. Similarly, \textit{PMM} contains two reflections and rotations \{$0^{\circ}$, $180^{\circ}$\}. \textit{PMM} can be generated by adding an additional reflection to both \textit{P2} (\{$0^{\circ}$, $180^{\circ}$\}) and \textit{PM} (one reflection), so \textit{P2} and \textit{PM} are both subgroups of \textit{PMM} with index 2 (see Figure \ref{fig:subgroups}C). The 17 wallpaper groups thus obey a hierarchy of complexity where simpler groups are subgroups of more complex ones \citep{RN1711}. 


\begin{figure}[hptb]
\centering
\includegraphics[width=0.75\linewidth]{figure1.pdf}
\caption{Subgroup relationships with indices 2 (solid lines) and 3 (dashed line) are shown in (A). All other relationships can be inferred by identifying the shortest path through the hierarchy, and multiplying the subgroup indices. For example, \textit{P1} is related to \textit{P6} through \textit{P6}\textrightarrow\textit{P3} (index 2) and \textit{P3}\textrightarrow\textit{P1} (index 3) so \textit{P1} is also a subgroup of \textit{P6} with index $3 \times 2 = 6$. We also show enlarged versions of some of the subgroup relationships involving \textit{P6} (B, shown in red) and \textit{PMM} (C, shown in blue) and highlight the symmetries within the subgroups to emphasize how the supergroup can be generated by adding additional transformations to the subgroup. Illustration adapted from \citet{wade_crystal_1993}.}
\label{fig:subgroups}
\end{figure}

\begin{figure}[hp]
\centering
\includegraphics[width=0.75\linewidth]{figure2.pdf}
\caption{Examples of each of the 16 wallpaper groups are shown in the left- and right-most column of the figures, next to the corresponding SSVEP (center-left) and psychological (center-right) data from each group. The SSVEP data are odd-harmonic-filtered cycle-average waveforms. In each cycle, a \textit{P1} exemplar was shown for the first 600 ms, followed by the original exemplar for the last 600 ms. Errorbars are standard error of the mean. Psychophysical data are presented as boxplots reflecting the distribution of display duration thresholds. The 16 groups are ordered by the strength of the SSVEP response, to highlight the range of response amplitudes.}
\label{fig:summary}
\end{figure}

The two datasets we present here (data and analysis code has been made available on \href{https://osf.io/f3ex8/}{OSF}) make it possible to assess the extent to which both behavior and brain responses follow the hierarchy of complexity expressed by the subgroup relationships. Based on previous brain imaging work showing that patterns with more axes of symmetry produce greater activity in visual cortex \citep{Sasaki_2005, Tyler_2005,RN1959, RN1725, keefe_2018}, we hypothesized that more complex groups would produce larger SSVEPs. For the psychophysical data, we hypothesized that more complex groups would lead to shorter symmetry detection thresholds, based on previous data showing that under a fixed presentation time, discriminability increases with the number of symmetry axes in the pattern \citep{wagemans_1991}. Our results confirm both hypotheses, and show that activity in human visual cortex is remarkably consistent with the hierarchical relationships between the wallpaper groups, with SSVEP amplitudes and psychophysical thresholds following these relationships at a level that is far beyond chance. The human visual system thus appears to encode all of the fundamental symmetries using a representational structure that closely approximates the subgroup relationships from group theory.

\section*{Results}

The stimuli used in our two experiments were generated from random-noise textures, which made it possible to generate multiple exemplars from each of the wallpaper groups, as described in detail elsewhere \citep{RN1725}. We generated control stimuli matched to each exemplar in the main stimulus set, by scrambling the phase but maintaining the power spectrum. All wallpaper groups are inherently periodic because of their repeating lattice structure. Phase scrambling maintains this periodicity, so the phase-scrambled control images all belong to group \textit{P1} regardless of group membership of the original exemplar. \textit{P1} contains no symmetries other than translation, while all other groups contain translation in combination with one or more of the other three fundamental symmetries (reflection, rotation, glide reflection) \citep{RN1425}. In our SSVEP experiment, this stimulus set allowed us to isolate brain activity specific to the symmetry structure in the exemplar images from activity associated with modulation of low-level features, by alternating exemplar images and control exemplars. In this design, responses to structural features beyond the shared power spectrum, including any symmetries other than translation, are isolated in the odd harmonics of the image update frequency \citep{RN1725,RN1540, RN1954}. Thus, the combined magnitude of the odd harmonic response components can be used as a measure of the overall strength of the visual cortex response.

The psychophysical experiment took a distinct but related approach. In each trial an exemplar image was shown with its matched control, one image after the other, and the order varied pseudo-randomly such that in half the trials the original exemplar was shown first, and in the other half the control image was shown first. After each trial, participants were instructed to indicate whether the first or second image contained more structure. The duration of both images was controlled by a staircase procedure so that a threshold duration for symmetry detection could be computed for each wallpaper group. 

Examples of the wallpaper groups and a summary of our brain imaging and psychophysical measurements are shown in Figure \ref{fig:summary}. For our primary SSVEP analysis, we only considered EEG data from a pre-determined region-of-interest (ROI) consisting of six electrodes over occipital cortex (see Supplementary Figure 1.1). SSVEP data from this ROI was filtered so that only the odd harmonics that capture the symmetry response contribute to the waveforms. While waveform amplitude is quite variable among the 16 groups, all groups have a sustained negative-going response that begins at about the same time for all groups, ~180 ms after the transition from the \textit{P1} control exemplar to the original exemplar. To reduce the amplitude of the symmetry-specific response to a single number that could be used in further analyses and compared to the psychophysical data, we computed the root-mean-square (RMS) over the odd-harmonic-filtered waveforms. The data in Figure 2 are shown in descending order according to RMS. The psychophysical results, shown in box plots in Figure \ref{fig:summary}, were also quite variable between groups, and there seems to be a general pattern where wallpaper groups near the top of the figure, that have lower SSVEP amplitudes, also have longer psychophysical threshold durations. 

We now wanted to test our two hypotheses about how SSVEP amplitudes and threshold durations would follow subgroup relationships, and thereby quantify the degree to which our two measurements were consistent with the group theoretical hierarchy of complexity. We tested each hypothesis using the same approach. We first fitted a Bayesian model with wallpaper group as a factor and participant as a random effect. We fit the model separately for SSVEP RMS and psychophysical data and then computed posterior distributions for the difference between supergroup and subgroup. These difference distributions allowed us to compute the conditional probability that the supergroup would produce (a) larger RMS and (b) a shorter threshold durations, when compared to the subgroup. The posterior distributions are shown in Figure \ref{fig:eeg_comp} for the SSVEP data, and in Figure \ref{fig:durations_comp} for the psychophysical data, which distributions color-coded according to conditional probability. For both data sets our hypothesis is confirmed: For the overwhelming majority of the 63 subgroup relationships, supergroups are more likely to produce larger symmetry-specific SSVEPs and shorter symmetry detection threshold durations, and in most cases the conditional probability of this happening is extremely high. 

We also ran a control analysis using (1) odd-harmonic SSVEP data from a six-electrode ROI over parietal cortex (see Supplementary Figure 1.1) and (2) even-harmonic SSVEP data from the same occipital ROI that was used in our primary analysis. By comparing these two control analysis to our primary SSVEP analysis, we can address the specify of our effects in terms of location (occipital cortex vs parietal cortex) and harmonic (odd vs even). For both control analyses (plotted in Supplementary Figures 3.3 and 3.4), the correspondence between data and subgroup relationships was substantially weaker than in the primary analysis. We can quantify the strength of the association between the data and the subgroup relationships, by asking what proportion of subgroup relationships that reach or exceed a range of probability thresholds. This is plotted in Figure \ref{fig:roc_style}, for our psychophysical data, our primary SSVEP analysis and our two control SSVEP analyses. It shows that odd-harmonic SSVEP data from the occipital ROI and symmetry detection threshold durations both have a strong association with the subgroup relationships such that a clear majority of the subgroups survive even at the highest threshold we consider ($p(\Delta>0|data)>0.99$). The association is far weaker for the two control analyses.

SSVEP data from four of the wallpaper groups (\textit{P2}, \textit{P3}, \textit{P4} and \textit{P6}) was previously published as part of our earlier demonstration of parametric responses to rotation symmetry in wallpaper groups\citep{RN1725}. We replicate that result using our Bayesian approach, and find an analogous parametric effect in the psychophysical data (see Supplementary Figure 4.1). We also conducted an analysis testing for an effect of index in our two datasets and found that subgroup relationships with higher indices tended to produce greater pairwise differences between the subgroup and supergroup, for both SSVEP RMS and symmetry detection thresholds (see Supplementary Figure 4.2). The effect of index is relatively weak, but the fact that there is a measurable index effect can nonetheless be taken as preliminary evidence that representations of symmetries in wallpaper groups may be compositional.

Finally, we conducted a correlation analysis comparing SSVEP and psychophysical data and found a reliable correlation ($R^2 = 0.44$, Bayesian confidence interval [0.28, 0.55]). The correlation reflects an inverse relationship: For subgroup relationships where the supergroup produces a much \textit{larger} SSVEP amplitude than the subgroup, the supergroup also tends to produce a much \textit{smaller} symmetry detection threshold. This is consistent with our hypotheses about how the two measurements relate to symmetry representations in the brain, and suggests that our brain imaging and psychophysical measurements are at least to some extent tapping into the same underlying mechanisms.

\begin{figure}[hp]
\centering
\includegraphics[width=0.75\linewidth]{subgroup_comp_eeg_rms.png}
\caption{Posterior distributions for the difference in mean SSVEP RMS amplitude. Colour coding of the text indicates the index of the subgroup, while the colour of the filled distribution relates to the conditional probability that the difference in means is greater than zero. We can see that 55/63 subgroup relationships have $p(\Delta >0 | data)>0.99$.}
\label{fig:eeg_comp}
\end{figure}

\begin{figure}[hptb]
\centering
\includegraphics[width=0.75\linewidth]{subgroup_comp_psychophysical.png}
\caption{Posterior distributions for the difference in mean symmetry detection threshold durations. Colour coding of the text indicates the index of the subgroup, while the colour of the filled distribution relates to the conditional probability that the difference in means is smaller than zero. We can see that 43/63 subgroup relationships have $p(\Delta <0 | data)>0.99$.}
\label{fig:durations_comp}
\end{figure}

\section*{Discussion}

Here we show that beyond merely responding to the elementary symmetry operations of reflection \citep{Sasaki_2005, Tyler_2005} and rotation \citep{RN1725}, the visual system represents the hierarchical structure of the 17 wallpaper groups, and thus every combination of the four fundamental symmetries (rotation, reflection, translation, glide reflection) which comprise the set of regular textures. Both SSVEP amplitudes and symmetry detection thresholds preserve the hierarchy of complexity among the wallpaper groups that is captured by the subgroup relationships \citep{RN1711}. For the SSVEP, this remarkable consistency was specific to the odd harmonics of the stimulus frequency that are known to capture the symmetry-specific response \citep{RN1725} and to electrodes in a region-of-interest (ROI) over occipital cortex. When the same analysis was done using the odd harmonics from electrodes over parietal cortex (Supplementary Figure 3.3) or even harmonics from electrodes over occipital cortex (Supplementary Figure 3.4), the data was substantially less consistent with the subgroup relationships (yellow and green lines, Figure 5).

The current study uses 16 distinct wallpaper groups, while previous neuroimaging studies focused on a subset of 4 \citep{RN1725,RN1959}. This represents a significant conceptual advance, because it makes it possible to investigate the complete subgroup hierarchy among the 17 groups and ask to what extent the hierarchy is reflected in brain activity. Our data provide a description of the visual system’s response to the complete set of symmetries in the two-dimensional plane. We do not independently measure the response to \textit{P1}, but because each of the 16 other groups produce non-zero odd harmonic amplitudes (see Figure \ref{fig:summary}), we can conclude that the relationships between P1 and all other groups, where \textit{P1} is the subgroup, are also preserved by the visual system. The subgroup relationships are in many cases not obvious perceptually, and most participants had no knowledge of group theory. Thus, the visual system’s ability to preserve the subgroup hierarchy does not depend on explicit knowledge of the relationships. Previous brain-imaging studies have found evidence of parametric responses with the number of reflection symmetry folds \cite{keefe_2018, Sasaki_2005, makin_2016} and with the order of rotation symmetry \cite{RN1725}. Our study is the first demonstration that the brain encodes symmetry in this parametric fashion across every possible combination of different \textit{symmetry types}, and that this parametric encoding is also reflected in behavior. Previous behavioral experiments have shown that although naïve observers can distinguish many of the wallpaper groups \citep{RN1253}, they tend to sort exemplars into fewer (4-12) sets than the number of wallpaper groups, often placing exemplars from different wallpaper groups in the same set \citep{RN172}. The two-interval forced choice approach we use in the current psychophysical experiment makes it possible to directly compare symmetry detection thresholds to the subgroup hierarchy, and reveals that not only can the 17 wallpaper groups be distinguished based on behavioral data, behavior largely follows the subgroup hierarchy.  

A large literature exists on the \textit{Sustained Posterior Negativity} (SPN), a characteristic negative-going waveform that is known to reflect responses to symmetry and other forms of regularity and structure \citep{makin_2016}. The SPN scales with the proportion of reflection symmetry in displays that contain a mixture of symmetry and noise \cite{makin_formation_2020, palumbo_scaling_2015}, and both reflection, rotation and translation can produce a measurable SPN \cite{makin_2013}. It has recently been demonstrated that a holographic model of regularity \citep{van_der_helm_1996}, can predict both SPN amplitude \citep{makin_2016} and perceptual discrimination performance \citep{nucci_2007} for dot patterns that contain symmetry and other types of regularity. The available evidence suggests that the SPN and our SSVEP measurements are two distinct methods for isolating the same symmetry-related brain response: When observed in the time-domain, the symmetry-selective odd-harmonic responses produce similarly sustained waveforms (see Figure \ref{fig:summary}), odd-harmonic SSVEP responses can be measured for dot patterns similar to those used to measure the SPN \citep{RN1954}, and the one event-related study on the wallpaper groups also found SPN-like waveforms \citep{RN1959}. Future work should more firmly establish the connection and determine if the SPN can capture similarly precise symmetry responses as the SSVEPs presented here. It would also be worthwhile to ask if and how \textit{W} can computed for our random-noise based wallpaper textures where combinations of symmetries tile the plane.    

We observe a reliable correlation between our brain imaging and psychophysical data. This suggests that the two measurements reflect the same underlying symmetry representations in visual cortex. It should be noted that the correlation is relatively modest ($R^2 = 0.44$). This may be partly due to the fact that different individuals participated in the two experiments. It may also be related to the fact that participants where not doing a symmetry-related task during the SSVEP experiment, but instead monitored the stimuli for brief changes in contrast that occured twice per trial (see Methods). Previous brain imaging studies have found enhanced reflection symmetry responses when participants performed a symmetry-related task \citep{makin_formation_2020, Sasaki_2005, keefe_2018}. It is possible that adding a symmetry-related task to our SSVEP experiment would have produced measurements that reflected subgroup relationships to an even higher extent than what we observed. On the other hand, our results are already close to ceiling (see Figure \ref{fig:roc_style}) and adding a symmetry-related task may simply enhance SSVEP amplitudes overall without improving the discriminality of individual groups, as has been observed for reflection by \cite{keefe_2018}. Task-driven processing may be important for detecting symmetries that have been subject to perspective distortion, as suggested by SPN measurements \citep{makin_conditions_2015} and somewhat less clearly in a subsequent functional MRI study \citep{keefe_2018}. Future work in which behavioral and brain imaging data are collected from the same participants, and task is manipulated in the SSVEP experiment, will help further establish the connection between the two measurements, and elucidate the potential contribution of task-related top-down processing to the current results.

We also find an effect of index for both our brain imaging measurements and our symmetry detection thresholds. This means that the visual system not only represents the hierarchical relationship captured by individual subgroups, but also distinguishes between subgroups depending on how many times the subgroup is repeated in the supergroup, with more repetitions leading to larger pairwise differences. Our measured effect of index is relatively weak. This is perhaps because the index analysis does not take into account the \textit{type} of isometries that differentiate the subgroup and supergroup. The effect of symmetry type can be observed by contrasting the measured SSVEP amplitudes and detection thresholds for groups \textit{PM} and \textit{PG} in Figure \ref{fig:summary}. The two groups are comparable except \textit{PM} contains reflection and \textit{PG} contains glide reflection, and the former clearly elicits higher amplitudes and lower thresholds. An important goal for future work will be to map out how different symmetry types contribute to the representational hierarchy. 

The correspondence between responses in the visual system and group theory that we demonstrate here, may reflect a form of implicit learning that depends on the structure of the natural world. The environment is itself constrained by physical forces underlying pattern formation and these forces are subject to multiple symmetry constraints \citep{RN1634}. The ordered structure of responses to wallpaper groups could be driven by a central tenet of neural coding, that of efficiency. If coding is to be efficient, neural resources should be distributed to capture the structure of the environment with minimum redundancy considering the visual geometric optics, the capabilities of the subsequent neural coding stages and the behavioral goals of the organism \citep{RN1758, RN1760, RN1757, RN1756}. Early work within the efficient coding framework suggested that natural images had a $1/f$ spectrum and that the corresponding redundancy between pixels in natural images could be coded efficiently with a sparse set of oriented filter responses, such as those present in the early visual pathway \citep{RN1740, RN1446}. Our results suggest that the principle of efficient coding extends to a much higher level of structural redundancy – that of symmetries in visual images. 

The 17 wallpaper groups are completely regular, and relatively rare in the visual environment, especially when considering distortions due to perspective (see above) and occlusion. Near-regular textures, however, abound in the visual world, and can be modeled as deformed versions of the wallpaper groups \citep{RN1519}. The correspondence between visual cortex responses and group theory demonstrated here may indicate that the visual system represents visual textures using a similar scheme, with the wallpaper groups serving as anchor points in representational space. This framework resembles norm-based encoding strategies that have been proposed for other stimulus classes, most notably faces \citep{RN435}, and leads to the prediction that adaptation to wallpaper patterns should distort perception of near-regular textures, similar to the aftereffects found for faces \citep{RN1768}. Field biologists have demonstrated that animals respond more strongly to exaggerated versions of a learned stimulus, referred to as “supernormal” stimuli \citep{RN1775}. In the norm-based encoding framework, wallpaper groups can be considered \textit{supertextures}, exaggerated examples of the near-regular textures common in the natural world. If non-human animals employ a similar encoding strategy, they would be expected to be sensitive to symmetries in wallpaper groups. Recent functional MRI work in macaque monkeys offer some support for that: Macaque visual cortex responds parametrically to reflection and rotation symmetries in wallpaper groups, and the set of brain areas involved largely overlap those observed to be sensitive to symmetry in humans \citep{audurier_symmetry_2021}. In human societies, visual artists may consciously or unconsciously create supernormal stimuli, to capture the essence of the subject and evoke strong responses in the audience \citep{RN1764}. Wallpaper groups are visually compelling, and symmetries have been widely used in human artistic expression going back to the Neolithic age \citep{RN1949}. If wallpapers are in fact supertextures, this prevalence may be a direct result of the strategy the human visual system has adopted for texture encoding. 

\begin{figure}[tbp]
\centering
\includegraphics[width=0.5\linewidth]{model_roc_style.pdf}
\caption{This plot shows the proportion of subgroup relationships that satisfy $p(\Delta >0 | data) > x$ for the SSVEP data and $p(\Delta <0 | data) > x$ for the psychophysical data. We can see that if we take $x = 0.95$ as our threshold, the subgroup relationships are preserved in 56/63 = 89\% and 48/63 = 76\% of the comparisons for the primary SSVEP and threshold duration datasets, receptively. This compares to the 32/63= 51\% and 22/63 = 35\% for the SSVEP control datasets.}
\label{fig:roc_style}
\end{figure}

\subsection*{Participants}
Twenty-five participants (11 females, mean age 28.7 \textpm\ 3.3) took part in the EEG experiment. Their informed consent was obtained before the experiment under a protocol that was approved by the Institutional Review Board of Stanford University. 11 participants (8 females, mean age 20.73 \textpm\ 1.21) took part in the psychophysics experiment. All participants had normal or corrected-to-normal vision. Their informed consent was obtained before the experiment under a protocol that was approved by the University of Essex's Ethics Committee. There was no overlap in participants between the EEG and psychophysics experiments.

\subsection*{Stimulus Generation}
Exemplars from the different wallpaper groups were generated using a modified version of the methodology developed by Clarke and colleagues\citep{RN172} that we have described in detail elsewhere\citep{RN1725}. Briefly, exemplar patterns for each group were generated from random-noise textures, which were then repeated and transformed to cover the plane, according to the symmetry axes and geometric lattice specific to each group. The use of noise textures as the starting point for stimulus generation allowed the creation of an almost infinite number of distinct exemplars of each wallpaper group. To make individual exemplars as similar as possible we replaced the power spectrum of each exemplar with the median across exemplars within a group. We then generated control exemplars that had the same power spectrum as the exemplar images by randomizing the phase of each exemplar image. The phase scrambling eliminates rotation, reflection and glide-reflection symmetries within each exemplar, but the phase-scrambled images inherent the spectral periodicity arising from the periodic tiling. This means that all control exemplars, regardless of which wallpaper group they are derived from, are transformed into another symmetry group, namely \textit{P1}. \textit{P1} is the simplest of the wallpaper groups and contains only translations of a region whose shape derives from the lattice. Because the different wallpaper groups have different lattices, \textit{P1} controls matched to different groups have different power spectra. Our experimental design takes these differences into account by comparing the neural responses evoked by each wallpaper group to responses evoked by the matched control exemplars.

\subsection*{Stimulus Presentation}
Stimulus Presentation. For the EEG experiment, the stimuli were shown on a 24.5" Sony Trimaster EL PVM-2541 organic light emitting diode (OLED) display at a screen resolution of $1920\times1080$ pixels, 8-bit color depth and a refresh rate of 60 Hz, viewed at a distance of 70 cm. The mean luminance was 69.93 cd/m2 and contrast was 95\%. The diameter of the circular aperture in which the wallpaper pattern appeared was $13.8^\circ$ of visual angle presented against a mean luminance gray background. Stimulus presentation was controlled using in-house software. For the psychophysics experiment, the stimuli were shown on a $48 \times 27$cm VIEWPixx/3D LCD Display monitor, model VPX-VPX-2005C, resolution $1920 \times 1080$ pixels, with a viewing distance of approximately 40cm and linear gamma. Stimulus presentation was controlled using MatLab and Psychtoolbox-3 \citep{kleiner2007,brainard1997spatial}. The diameter of the circular aperture for the stimuli was $21.5^\circ$.

\subsection*{EEG Procedure}
Visual Evoked Potentials were measured using a steady-state design, in which \textit{P1} control images alternated with exemplar images from each of the 16 other wallpaper groups. Exemplar images were always preceded by their matched \textit{P1} control image. A single 0.83 Hz stimulus cycle consisted of a control \textit{P1} image followed by an exemplar image, each shown for 600 ms. A trial consisted of 10 such cycles (12 sec) over which 10 different exemplar images and matched controls from the same rotation group were presented. For each group type, the individual exemplar images were always shown in the same order within the trials. Participants initiated each trial with a button-press, which allowed them to take breaks between trials. Trials from a single wallpaper group were presented in blocks of four repetitions, which were themselves repeated twice per session, and shown in random order within each session. To control fixation, the participants were instructed to fixate a small white cross in the center of display. To control vigilance, a contrast dimming task was employed. Two times per trial, an image pair (control \textit{P1} plus exemplar) was shown at reduced contrast. Participants were instructed to press a button on a response pad whenever they noticed a contrast change. Reaction times were not taken into account and participants were told to respond at their own pace while being as accurate as possible. We adjusted the reduction in contrast such that average accuracy for each participant was kept at ~85\% correct, in order to keep the difficulty of the vigilance task at a constant level.

\subsection*{Psychophysics Procedure}
The experiment consisted of 16 blocks, one for each of the wallpaper groups (excluding \textit{P1}). We used a two-interval forced choice approach. In each trial, participants were presented with two stimuli (one of which was the wallpaper group for the current block of trials, the other being \textit{P1}), one after the other (inter-stimulus interval of 700ms). After each stimulus had been presented, it was masked with white noise for 300ms. After both stimuli had been presented, participants made a response on the keyboard to indicate whether they thought the first or second image contained more symmetry. Each block started with 10 practice trials, (stimulus display duration of 500ms) to allow participants to familiarise themselves with the current block's wallpaper pattern. If they achieved an accuracy of 9/10 in these trials they progressed to the rest of the block, otherwise they carried out another set of 10 practise trials. This process was repeated until the required accuracy of 9/10 was obtained. The rest of the block consisted of four interleaved staircases (using the QUEST algorithm \citep{watson1983quest}, full details given in the SI) of 30 trials each. On average, a block of trials took around 10 minutes to complete. 

\subsection*{EEG Acquisition and Preprocessing}
Steady-State Visual Evoked Potentials (SSVEPs) were collected with 128-sensor HydroCell Sensor Nets (Electrical Geodesics, Eugene, OR) and were band-pass filtered from 0.3 to 50 Hz. Raw data were evaluated off line according to a sample-by-sample thresholding procedure to remove noisy sensors that were replaced by the average of the six nearest spatial neighbors. On average, less than 5\% of the electrodes were substituted; these electrodes were mainly located near the forehead or the ears. The substitutions can be expected to have a negligible impact on our results, as the majority of our signal can be expected to come from electrodes over occipital, temporal and parietal cortices. After this operation, the waveforms were re-referenced to the common average of all the sensors. The data from each 12s trial were segmented into five 2.4 s long epochs (i.e., each of these epochs was exactly 2 cycles of image modulation). Epochs for which a large percentage of data samples exceeding a noise threshold (depending on the participant and ranging between 25 and 50 $\mu$V) were excluded from the analysis on a sensor-by-sensor basis. This was typically the case for epochs containing artifacts, such as blinks or eye movements. Steady-state stimulation will drive cortical responses at specific frequencies directly tied to the stimulus frequency. It is thus appropriate to quantify these responses in terms of both phase and amplitude. Therefore, a Fourier analysis was applied on every remaining epoch using a discrete Fourier transform with a rectangular window. The use of two-cycle long epochs (i.e., 2.4 s) was motivated by the need to have a relatively high resolution in the frequency domain, $\delta$f = 0.42 Hz. For each frequency bin, the complex-valued Fourier coefficients were then averaged across all epochs within each trial. Each participant did two sessions of 8 trials per condition, which resulted in a total of 16 trials per condition.

\subsection*{SSVEP Analysis}
Response waveforms were generated for each group by selective filtering in the frequency domain. For each participant, the average Fourier coefficients from the two sessions were averaged over trials and sessions. The SSVEP paradigm we used allowed us to separate symmetry-related responses from non-specific contrast transient responses. Previous work has demonstrated that symmetry-related responses are predominantly found in the odd harmonics of the stimulus frequency, whereas the even harmonics consist mainly of responses unrelated to symmetry, that arise from the contrast change associated with the appearance of the second image \citep{RN1954, RN1725}. This functional distinction of the harmonics allowed us to generate a single-cycle waveform containing the response specific to symmetry, by filtering out the even harmonics in the spectral domain, and then back-transforming the remaining signal, consisting only of odd harmonics, into the time-domain. For our main analysis, we averaged the odd harmonic single-cycle waveforms within a six-electrode region of interest (ROI) over occipital cortex (electrodes 70, 74, 75, 81, 82, 83). These waveforms, averaged over participants, are shown in Figure \ref{fig:summary}. The same analysis was done for the even harmonics and for the odd harmonics within a six electrode ROI over parietal cortex (electrodes 53, 54, 61, 78, 79, 86; see Supplementary Figure 1.1). The root-mean square values of these waveforms, for each individual participant, were used to determine whether each of the wallpaper subgroup relationships were preserved in the brain data.  

\subsection*{Defining the list of subgroup relationships}
In order to get the complete list of subgroup relationships, we digitized Table 4 from Coxeter \citep{RN1711} (shown in Supplementary Table 1.2). After removing identity relationships (i.e. each group is a subgroup of itself) and the three pairs of wallpapers groups that are subgroups of each other (e.g. \textit{PM} is a subgroup of \textit{CM}, and \textit{CM} is a subgroup of \textit{PM}) we were left with a total of 63 unambiguous subgroups that were included in our analysis. 

\subsection*{Bayesian Analysis of SSVEP and Psychophysical data}
Bayesian analysis was carried out using R (v3.6.1) \citep{R} with the \texttt{brms} package (v2.9.0) \citep{burkner2017} and rStan (v2.19.2 \citep{rStan}). The data from each experiment were modelled using a Bayesian generalised mixed effect model with wallpaper group being treated as a 16-level factor, and random effects for participant. The SSVEP data and symmetry detection threshold durations were modelled using log-normal distributions with weakly informative, $ \mathcal{N}(0, 2)$, priors. After fitting the model to the data, samples were drawn from the posterior distribution of the two datasets, for each wallpaper group. These samples were then recombined to calculate the distribution of differences for each of the 63 pairs of subgroup and supergroup. These distributions were then summarised by computing the conditional probability of obtaining a positive (or for the psychophysical data, negative) difference, $p(\Delta | \text{data})$. For further technical details, please see the Supplementary Materials where the full R code, model specification, prior and posterior predictive checks, and model diagnostics, can be found. 

\subsection*{Acknowledgments}
The authors would like to thank two anonymous reviewers whose comments helped improve and clarify the manuscript, and also express their gratitude to Professor Anthony M. Norcia for his invaluable mentorship and contribution to our thinking about the role of symmetry in vision, and about vision and the brain more generally, through years of collaboration and discussions. This work was supported by the Vision Science to Applications (VISTA) program funded by the Canada First Research Excellence Fund (CFREF, 2016–2023) and by a Discovery Grant from the Natural Sciences and Engineering Research Council of Canada awarded to PJK. The work was also partially supported by a National Science Foundation INSPIRE grant 1248076 awarded to Yanxi Liu, Anthony M. Norcia and Rick O. Gilmore. A preliminary version of the EEG portion of the manuscript was previously deposited on \href{https://doi.org/10.1101/223743}{bioRxiv}.

\subsection*{Data Accessibility}
Data from the EEG and Psychophysics experiments have been made available with the Supplementary Material on \href{https://osf.io/f3ex8/}{OSF}.

% Bibliography
\begin{multicols}{2}
\small
\bibliographystyle{apalike} 
\bibliography{kohler_clarke_2021.bbl}
\end{multicols}

\end{document}