subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-c(group, normal, label),
values_to = "index",
names_to = "subgroup")
subgroups
index_dat  <- read_csv("../subgroups/subgroup_relations.csv")
normal_dat <- read_csv("../subgroups/subgroup_normal.csv")
# sort out group names
group_names  <- str_to_upper(index_dat$group)
index_dat  <- index_dat[, -1]
normal_dat <- normal_dat[, -1]
# remove p1
group_names  <- group_names[-1]
index_dat  <- select(index_dat[-1,], -p1)
normal_dat <- select(normal_dat[-1,], -p1)
subgroups <- tibble(
group = as.character(),
subgroup = as.character(),
index = as.numeric(),
normal = as.logical())
for (ii in 1:nrow(index_dat)) {
for (jj in 1:ncol(index_dat)) {
subgroups <- add_row(subgroups,
group = group_names[jj],
subgroup = group_names[ii],
index = as.numeric(index_dat[ii,jj]),
normal = normal_dat[ii,jj] == 1)
}
}
# list of comparisons to remove
to_remove <- list(
"PM-CM", "CM-PM",
"PMM-CMM", "CMM-PMM",
"P3M1-P31M", "P31M-P3M1")
to_remove <- append(to_remove, unlist(paste(group_names, "-", group_names, sep = "")))
subgroups
source("scripts/import_subgroup_comparisons.R")
opts <- options(knitr.kable.NA = "")
knitr::kable(index_table, caption = "subgroup index", escape = "F") %>% kableExtra::kable_styling(full_width = F)
source("scripts/import_subgroup_comparisons.R")
opts <- options(knitr.kable.NA = "")
knitr::kable(index_table, caption = "subgroup index", escape = "F") %>% kableExtra::kable_styling(full_width = F)
source("scripts/import_subgroup_comparisons.R")
index_table
index_table[1,1]
index_table[2,2]
index_table[2,2][1]
index_table[2,2][[1]]
source("scripts/import_subgroup_comparisons.R")
opts <- options(knitr.kable.NA = "")
knitr::kable(index_table, caption = "subgroup index", escape = "F") %>% kableExtra::kable_styling(full_width = F)
source("scripts/import_subgroup_comparisons.R")
opts <- options(knitr.kable.NA = "")
knitr::kable(index_table, caption = "subgroup index", escape = "F") %>% kableExtra::kable_styling(full_width = F)
source("scripts/import_subgroup_comparisons.R")
opts <- options(knitr.kable.NA = "")
knitr::kable(index_table, caption = "subgroup index", escape = "F") %>% kableExtra::kable_styling(full_width = F)
subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = index)
subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-c(group, normal),
values_to = "index",
names_to = "subgroup")
index_dat  <- read_csv("../subgroups/subgroup_relations.csv")
normal_dat <- read_csv("../subgroups/subgroup_normal.csv")
# sort out group names
group_names  <- str_to_upper(index_dat$group)
index_dat  <- index_dat[, -1]
normal_dat <- normal_dat[, -1]
# remove p1
group_names  <- group_names[-1]
index_dat  <- select(index_dat[-1,], -p1)
normal_dat <- select(normal_dat[-1,], -p1)
subgroups <- tibble(
group = as.character(),
subgroup = as.character(),
index = as.numeric(),
normal = as.logical())
for (ii in 1:nrow(index_dat)) {
for (jj in 1:ncol(index_dat)) {
subgroups <- add_row(subgroups,
group = group_names[jj],
subgroup = group_names[ii],
index = as.numeric(index_dat[ii,jj]),
normal = normal_dat[ii,jj] == 1)
}
}
# list of comparisons to remove
to_remove <- list(
"PM-CM", "CM-PM",
"PMM-CMM", "CMM-PMM",
"P3M1-P31M", "P31M-P3M1")
to_remove <- append(to_remove, unlist(paste(group_names, "-", group_names, sep = "")))
subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-c(group, normal),
values_to = "index",
names_to = "subgroup")
source("scripts/import_subgroup_comparisons.R")
opts <- options(knitr.kable.NA = "")
knitr::kable(index_table, caption = "subgroup index", escape = "F") %>% kableExtra::kable_styling(full_width = F)
subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = index)
index_dat  <- read_csv("../subgroups/subgroup_relations.csv")
normal_dat <- read_csv("../subgroups/subgroup_normal.csv")
# sort out group names
group_names  <- str_to_upper(index_dat$group)
index_dat  <- index_dat[, -1]
normal_dat <- normal_dat[, -1]
# remove p1
group_names  <- group_names[-1]
index_dat  <- select(index_dat[-1,], -p1)
normal_dat <- select(normal_dat[-1,], -p1)
subgroups <- tibble(
group = as.character(),
subgroup = as.character(),
index = as.numeric(),
normal = as.logical())
for (ii in 1:nrow(index_dat)) {
for (jj in 1:ncol(index_dat)) {
subgroups <- add_row(subgroups,
group = group_names[jj],
subgroup = group_names[ii],
index = as.numeric(index_dat[ii,jj]),
normal = normal_dat[ii,jj] == 1)
}
}
# list of comparisons to remove
to_remove <- list(
"PM-CM", "CM-PM",
"PMM-CMM", "CMM-PMM",
"P3M1-P31M", "P31M-P3M1")
to_remove <- append(to_remove, unlist(paste(group_names, "-", group_names, sep = "")))
subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = index)
subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-c(group, normal),
values_to = "index",
names_to = "subgroup")
subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-c(group, normal),
values_to = "index",
names_to = "subgroup") %>%
mutate(
colour_code = if_else(paste(group, subgroup, sep="-") %in% to_remove, 2, 1),
# index = if_else(is.na(index), "-", index)
# index = kableExtra::cell_spec(
#     index,
#     italic = if_else(normal == TRUE, TRUE, FALSE),
#     color = kableExtra::spec_color(colour_code, end = 0.9, na_color = "#FFFFFF")),
)
subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-c(group, normal),
values_to = "index",
names_to = "subgroup") %>%
mutate(
colour_code = if_else(paste(group, subgroup, sep="-") %in% to_remove, 2, 1),
# index = if_else(is.na(index), "-", index)
index = kableExtra::cell_spec(
index,
italic = if_else(normal == TRUE, TRUE, FALSE),
color = kableExtra::spec_color(colour_code, end = 0.9, na_color = "#FFFFFF")),
) %>%
select(group, subgroup, index)
subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-c(group, normal),
values_to = "index",
names_to = "subgroup") %>%
mutate(
colour_code = if_else(paste(group, subgroup, sep="-") %in% to_remove, 2, 1),
# index = if_else(is.na(index), "-", index)
index = kableExtra::cell_spec(
index,
italic = if_else(normal == TRUE, TRUE, FALSE),
color = kableExtra::spec_color(colour_code, end = 0.9, na_color = "#FFFFFF")),
) %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = group,
values_from = index)
subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-c(group, normal),
values_to = "index",
names_to = "subgroup") %>%
mutate(
colour_code = if_else(paste(group, subgroup, sep="-") %in% to_remove, 2, 1),
# index = if_else(is.na(index), "-", index)
index = kableExtra::cell_spec(
index,
italic = if_else(normal == TRUE, TRUE, FALSE),
color = kableExtra::spec_color(colour_code, end = 0.9, na_color = "#FFFFFF")),
) %>%
select(group, subgroup, index)
16*16
subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-c(group, normal),
values_to = "index",
names_to = "subgroup")
subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = index)
subgroups %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = subgroup,
values_from = index)
subgroups %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-c(group, normal),
values_to = "index",
names_to = "subgroup")
subgroups %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = subgroup,
values_from = c(index, normal))
subgroups %>%
pivot_wider(
names_from = subgroup,
values_from = c(index, normal))
subgroups %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = subgroup,
values_from = index)
subgroups %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-group,
values_to = "index",
names_to = "subgroup")
subgroups
subgroups %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-group,
values_to = "index",
names_to = "subgroup") %>%
left_join(subgroups)
subgroups %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-group,
values_to = "index",
names_to = "subgroup") %>%
left_join(subgroups)
mutate(
colour_code = if_else(paste(group, subgroup, sep="-") %in% to_remove, 2, 1),
# index = if_else(is.na(index), "-", index)
index = kableExtra::cell_spec(
index,
italic = if_else(normal == TRUE, TRUE, FALSE),
color = kableExtra::spec_color(colour_code, end = 0.9, na_color = "#FFFFFF")),
) %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = group,
values_from = index) -> index_table
ubgroups %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-group,
values_to = "index",
names_to = "subgroup") %>%
left_join(subgroups)
mutate(
colour_code = if_else(paste(group, subgroup, sep="-") %in% to_remove, 2, 1),
# index = if_else(is.na(index), "-", index)
index = kableExtra::cell_spec(
index,
italic = if_else(normal == TRUE, TRUE, FALSE),
color = kableExtra::spec_color(colour_code, end = 0.9, na_color = "#FFFFFF")),
)
-group,
values_to = "index",
names_to = "subgroup") %>%
left_join(subgroups) %>%
mutate(
-group,
values_to = "index",
names_to = "subgroup") %>%
left_join(subgroups) %>%
mutate(
names_from = group,
values_from = index) -> index_table
subgroups %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-group,
values_to = "index",
names_to = "subgroup") %>%
left_join(subgroups) %>%
mutate(
colour_code = if_else(paste(group, subgroup, sep="-") %in% to_remove, 2, 1),
# index = if_else(is.na(index), "-", index)
index = kableExtra::cell_spec(
index,
italic = if_else(normal == TRUE, TRUE, FALSE),
color = kableExtra::spec_color(colour_code, end = 0.9, na_color = "#FFFFFF")),
) %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = group,
values_from = index) -> index_table
index_table
knitr::kable(index_table, caption = "subgroup index", escape = "F") %>% kableExtra::kable_styling(full_width = F)
subgroups %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = subgroup,
values_from = index) %>%
pivot_longer(
-group,
values_to = "index",
names_to = "subgroup") %>%
left_join(subgroups) %>%
mutate(
colour_code = if_else(paste(group, subgroup, sep="-") %in% to_remove, 2, 1),
index = as.character(index),
index = if_else(is.na(index), "-", index),
index = kableExtra::cell_spec(
index,
italic = if_else(normal == TRUE, TRUE, FALSE),
color = kableExtra::spec_color(colour_code, end = 0.9, na_color = "#FFFFFF")),
) %>%
select(group, subgroup, index) %>%
pivot_wider(
names_from = group,
values_from = index) -> index_table
knitr::kable(index_table, caption = "subgroup index", escape = "F") %>% kableExtra::kable_styling(full_width = F)
56/63
49/63
32/63
22/63
library(bookdown)
library(tidyverse)
library(brms)
library(tidybayes)
library(ggridges)
library(latex2exp)
library(see)
library(ggthemes)
library(patchwork)
library(magick)
knitr::opts_chunk$set(echo = FALSE, message=FALSE, fig.align='center')
options(knitr.table.format = "html")
# specify some colours to use in the plots
v_cols <- ggthemes::ptol_pal()(6)
# read in some helper functions that will be used later
source("scripts/helper_functions.R")
options(mc.cores = parallel::detectCores())
fl <- "rms_Occ_Odd.csv"
# set column types
my_cols <- cols(
.default = col_double(),
Row = col_character()
)
#import
read_csv(paste("data/", fl, sep = ""), col_types = my_cols) %>%
rename(wg = "Row") %>%
gather("subject", "rms", -wg) %>%
glimpse() -> d_eeg
d_eeg -> filter(wg %in% c("P2", "P3", "P4", "P6"))
fl <- "rms_Occ_Odd.csv"
# set column types
my_cols <- cols(
.default = col_double(),
Row = col_character()
)
#import
read_csv(paste("data/", fl, sep = ""), col_types = my_cols) %>%
rename(wg = "Row") %>%
gather("subject", "rms", -wg) %>%
glimpse() -> d_eeg
d_eeg
d_eeg -> filter(wg %in% c("P2", "P3", "P4", "P6"))
d_eeg %>% filter(wg %in% c("P2", "P3", "P4", "P6"))
d_eeg %>% filter(wg %in% c("P2", "P3", "P4", "P6")) -> d_eeg_rot
d_eeg_rot
d_eeg %>% filter(wg %in% c("P2", "P3", "P4", "P6")) %>%
mutate(orientation = extract_numeric(wg))-> d_eeg_rot
d_eeg_rot
m_eeg_rot <- brm(data = d_eeg_rot, rms ~ orientation, family = "lognormal")
summary(m_eeg_rot)
m_eeg_rot <- brm(data = d_eeg_rot, rms ~ orientation + (1|subject), family = "lognormal")
summary(m_eeg_rot)
d_eeg_rot %>% modelr::data_grid(orientation)
d_eeg_rot %>% modelr::data_grid(orientation)
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot)
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NULL)
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NULL)
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NULL)
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NA)
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NA) %>%
ggplot(aes(x = orientation, y = .value, group = .draw)) + geom_path()
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NA) %>%
ggplot(aes(x = orientation, y = .value, group = .draw)) + geom_path(alpha = .1, colour = "thistle4")
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NA, n=100) %>%
ggplot(aes(x = orientation, y = .value, group = .draw)) + geom_path(alpha = .1, colour = "thistle4")
theme_minimal()
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NA, n=100) %>%
ggplot(aes(x = orientation, y = .value, group = .draw)) + geom_path(alpha = .1, colour = "thistle4") +
geom_point(data = d_eeg_rot, aes(x = orientation, y = log(rms))) +
theme_minimal()
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NA, n=100) %>%
ggplot() +
geom_path(aes(x = orientation, y = .value, group = .draw), alpha = .1, colour = "thistle4") +
geom_point(data = d_eeg_rot, aes(x = orientation, y = log(rms))) +
theme_minimal()
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NA, n=100) %>%
ggplot() +
geom_path(aes(x = orientation, y = .value, group = .draw), alpha = .1, colour = "thistle4") +
geom_point(data = d_eeg_rot, aes(x = orientation, y = rms)) +
theme_minimal()
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NA, n=100) %>%
ggplot() +
geom_path(aes(x = orientation, y = .value, group = .draw), alpha = .1, colour = "thistle4") +
geom_jitter(data = d_eeg_rot, aes(x = orientation, y = rms), alpha = 0.5) +
theme_minimal()
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NA, n=100) %>%
ggplot() +
geom_path(aes(x = orientation, y = .value, group = .draw), alpha = .1, colour = "thistle4") +
geom_jitter(data = d_eeg_rot, aes(x = orientation, y = rms), alpha = 0.5) +
theme_minimal(width = 0.2)
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NA, n=100) %>%
ggplot() +
geom_path(aes(x = orientation, y = .value, group = .draw), alpha = .1, colour = "thistle4") +
geom_jitter(data = d_eeg_rot, aes(x = orientation, y = rms), alpha = 0.5, width = 0.2) +
theme_minimal()
d_eeg_rot %>% modelr::data_grid(orientation) %>%
add_fitted_draws(m_eeg_rot, re_formula = NA, n=100) %>%
ggplot() +
geom_path(aes(x = orientation, y = .value, group = .draw), alpha = .1, colour = "thistle4") +
geom_jitter(data = d_eeg_rot, aes(x = orientation, y = rms), alpha = 0.5, width = 0.1) +
theme_minimal()
summary(m_eeg_rot)
?ggplot2::scale_x_continuous
